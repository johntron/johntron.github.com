
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Interactively debug Django applications - Johntron.com</title>
  <meta name="author" content="John Syrinek">

  
  <meta name="description" content="Quit banging your head and learn to debug your Python web application using an interactive stack trace. If you use Apache with mod_wsgi to host a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://johntron.github.com/programming/interactively-debug-django-applications/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Johntron.com" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Johntron.com</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:johntron.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Interactively Debug Django Applications</h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-21T00:00:00-06:00" pubdate data-updated="true">Nov 21<span>st</span>, 2009</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Quit banging your head and learn to debug your Python web application using an interactive stack trace. If you use Apache with mod_wsgi to host a Python application, it is possible to use the Python Debugger (pdb) to trace your code through the console. I use this three-step method to debug my Django projects. I thought about using the <a href="http://rob.cogit8.org/blog/2008/Sep/19/introducing-django-debug-toolbar/">Django Debug Toolbar</a>, but this can only be used in HTML responses. For instance, JSON, XML, or Plaintext responses cannot be debugged with the toolbar.</p>

<h2>Step one: Wrap your WSGI application in a Debugger class</h2>

<p>Edit your WSGI script (specified in your Apache configuration file) to wrap your WSGI application in a Debugger class.<br/>
[python]import os<br/>
import sys</p>

<p>sys.path.append( ‘/www/yourproject’ )<br/>
os.environ[&#8216;DJANGO_SETTINGS_MODULE&#8217;] = ‘settings’<br/>
import django.core.handlers.wsgi<br/>
import settings</p>

<p>if settings.INTERACTIVE_DEBUG:<br/>
class Debugger:</p>

<p>def __init__(self, object):<br/>
self.__object = object</p>

<p>def __call__(self, *args, **kwargs):<br/>
import pdb, sys<br/>
debugger = pdb.Pdb()<br/>
debugger.use_rawinput = 0<br/>
debugger.reset()<br/>
sys.settrace(debugger.trace_dispatch)</p>

<p>try:<br/>
return self.__object(*args, **kwargs)<br/>
finally:<br/>
debugger.quitting = 1<br/>
sys.settrace(None)</p>

<p>application = Debugger( django.core.handlers.wsgi.WSGIHandler() )<br/>
else:<br/>
application = django.core.handlers.wsgi.WSGIHandler()[/python]<br/>
See <a href="http://code.google.com/p/modwsgi/wiki/DebuggingTechniques">modwsgi Debugging Techniques</a> (and scroll down quite a bit) for more information.</p>

<h2>Step two: Add INTERACTIVE_DEBUG to settings</h2>

<p>In your settings.py file, add the following just below <em>DEBUG = True</em>:<br/>
<code>INTERACTIVE_DEBUG = True</code></p>

<h2>Step two: Restart Apache in interactive mode</h2>

<p>In your console (as root) type the following:</p>

<p>[bash]apache2ctl stop<br/>
apache2ctl -X<br/>
[/bash]</p>

<p>This should appear to hang. It’s actually just waiting for you to load a page. Move on.</p>

<h2>Step three: Request a webpage</h2>

<p>Now, just request a webpage from your server like normal and notice your browser hanging now as well. This is because the Python Debugger (pdb) is waiting for input from you. If you switch back to your console, you should see a pdb prompt. From this point on, you can issue pdb commands in the interactive pdb prompt like you would for any Python application. See <a href="http://docs.python.org/library/pdb.html#debugger-commands">pdb commands</a> for more info.</p>

<p>Here’s a list of the most common commands:</p>

<ul>
<li><strong>b myproject/app/file.py:23</strong> – Set breakpoint on line 23 of myproject/app/file.py (should be in your python path)</li>
<li><strong>c</strong> – Continue and stop at any breakpoints you’ve set</li>
<li><strong>w</strong> – Show backtrace to current position</li>
<li><strong>l</strong> – List sourcecode in current file</li>
<li><strong>s</strong> – Continue and stop at next possible occasion</li>
<li><strong>n</strong> – Continue and stop at next line of current function or when function returns</li>
<li><strong>print var</strong> – Print’s python variable <em>var</em></li>
</ul>


<p>In addition to these commands, you can also run any Python code as long as they don’t conflict with these commands.</p>

<p>If this helps, be sure to leave a comment. Thanks!</p>

<p><strong>Updated 23 Nov 2010: </strong>Added INTERACTIVE_DEBUG feature.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Johntron</span></span>

      








  


<time datetime="2009-11-21T00:00:00-06:00" pubdate data-updated="true">Nov 21<span>st</span>, 2009</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/programming/'>programming</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://johntron.github.com/programming/interactively-debug-django-applications/" data-via="johntron" data-counturl="http://johntron.github.com/programming/interactively-debug-django-applications/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/utilities/url-scrubber/" title="Previous Post: URL Scrubber">&laquo; URL Scrubber</a>
      
      
        <a class="basic-alignment right" href="/economics/eventual-sale/" title="Next Post: Piracy, Early Adoption, and Eventual Sale">Piracy, Early Adoption, and Eventual Sale &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/hacking/ubuntu-12-boot-process-explained/">Ubuntu 12 boot process explained</a>
      </li>
    
      <li class="post">
        <a href="/advice/effective-graph-layout/">Effective Graph Layout</a>
      </li>
    
      <li class="post">
        <a href="/programming/better-logging-with-loggly-and-symfony-2/">Better logging with Loggly and Symfony 2</a>
      </li>
    
      <li class="post">
        <a href="/advice/dell-design-library/">DELL Design Library</a>
      </li>
    
      <li class="post">
        <a href="/mobile/how-to-root-a-kindle-fire-on-os-x/">How to root a Kindle Fire on OS X</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/johntron">@johntron</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'johntron',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("johntron", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/johntron" class="twitter-follow-button" data-show-count="false">Follow @johntron</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/johntron?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - John Syrinek -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
