
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>SSH-FTP &#038; Subversion without shell access - Johntron.com</title>
  <meta name="author" content="John Syrinek">

  
  <meta name="description" content="Granting shell access to third-parties can be a security nightmare if done improperly. Even with the best intentions, clients can accidentally delete &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://johntron.github.com/advice/sftp-svn-without-login/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Johntron.com" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Johntron.com</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:johntron.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">SSH-FTP &#038; Subversion Without Shell Access</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-18T00:00:00-05:00" pubdate data-updated="true">Oct 18<span>th</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content"><p><em>Granting shell access to third-parties can be a security nightmare if done improperly. Even with the best intentions, clients can accidentally delete mission-critical files or shut down crucial services, and clients are the least of your concerns. Servers across the world are constantly attacked by zombie computers. One of the more common forms of attacks are brute force attempts at obtaining shell access through SSH. Servers with plaintext passwords are the first to fall victim to viri, worms, or other nasty intrusions. Here’s how to provide access the correct way.</em></p>

<p>This method provides file transfer access through the SSH File Transfer Protocol (SFTP – this is different from FTP plus SSL). In addition, it allows third-parties to checkout from (and commit changes to) a Subversion repository. This method does NOT allow SSH shell access, because you should assume granting this kind of privileged access to an unexperienced user is a security risk – at least without further configuration.</p>

<p><strong>Steps to enable SFTP and Subversion access for a user account:</strong></p>

<ol>
<li>Generate a private-/public-key combination using <code>ssh-keygen</code></li>
<li>Copy public-key to server</li>
<li>Disable password-based authentication (recommended but not required)</li>
<li>Lock the user account</li>
<li>Force the <code>svnserve</code> tunneling daemon to run upon login</li>
<li>Connect to server with SFTP and Subversion</li>
</ol>


<h3>Steps 1 and 2: Generate keys and copy public key to server</h3>

<p>Begin by setting up private-/public- shared SSH authentication keys. There are plenty of tutorials on how to do this, so refer to one of these: <a href="http://oreilly.com/pub/h/66" target="_blank">Quick Logins with ssh Client Keys</a>.</p>

<h3>Step 3: Disable password-based authentication</h3>

<p>This step is not required, but you’ve already bothered with setting up authentication keys. Why not? Passwords will never be sent over the wire. On the upside, keys also make connecting to a server faster (no passwords to type!). To do this, simply edit <code>sshd_config</code> (usually under <code>/etc/ssh/sshd_config</code>), change <code>PasswordAuthentication</code> to <code>no</code>, then restart <code>sshd</code> – make sure you can connect with your new keys first!</p>

<h3>Steps 4 and 5: Lock the user account and force <code>svnserve -t</code></h3>

<p>Next, lock the user account and force the svnserve tunneling daemon to run upon login like so: <a href="http://blog.bigsmoke.us/2008/08/04/disabling-ssh-shell-access-for-svn-users-on-a-linuxunix-system" target="_blank">Disabling SSH shell access for SVN users on a Linux/Unix system</a></p>

<h3>Step 6: Connect to server with SFTP and Subversion</h3>

<p>You should now be able to use SFTP to transfer files to and from the server. You must provide a username, but no password will be required (your key will be used instead). For Subversion, repository paths should use the <code>svn+ssh://</code> scheme with a username like so: <code>svn co svn+ssh://myusername@somedomain.com/path/to/repo</code></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Johntron</span></span>

      








  


<time datetime="2010-10-18T00:00:00-05:00" pubdate data-updated="true">Oct 18<span>th</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/advice/'>Advice</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://johntron.github.com/advice/sftp-svn-without-login/" data-via="johntron" data-counturl="http://johntron.github.com/advice/sftp-svn-without-login/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/programming/python-site-packages/" title="Previous Post: Python site-packages">&laquo; Python site-packages</a>
      
      
        <a class="basic-alignment right" href="/advice/the-elusive-expert-web-developer/" title="Next Post: The Elusive Expert Web Developer">The Elusive Expert Web Developer &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/hacking/ubuntu-12-boot-process-explained/">Ubuntu 12 boot process explained</a>
      </li>
    
      <li class="post">
        <a href="/advice/effective-graph-layout/">Effective Graph Layout</a>
      </li>
    
      <li class="post">
        <a href="/programming/better-logging-with-loggly-and-symfony-2/">Better logging with Loggly and Symfony 2</a>
      </li>
    
      <li class="post">
        <a href="/advice/dell-design-library/">DELL Design Library</a>
      </li>
    
      <li class="post">
        <a href="/mobile/how-to-root-a-kindle-fire-on-os-x/">How to root a Kindle Fire on OS X</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/johntron">@johntron</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'johntron',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("johntron", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/johntron" class="twitter-follow-button" data-show-count="false">Follow @johntron</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/johntron?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - John Syrinek -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
